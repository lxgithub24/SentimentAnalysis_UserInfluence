var Base={config:{},cache:{},getKeysByType:function(c){var d=(c||"class").toLowerCase();var a=d+"LoadFinished";var b=d+"LoadFnArray";var e=d+"LoadMap";this[a]=(typeof this[a]==="boolean")?this[a]:true;this[b]=this[b]||[];this[e]=this[e]||{};return{status:a,array:b,map:e,type:d}},updateLoadStatus:function(e,a,c){var d=this.getKeysByType(c);if(e){this[d.map][e]=a;if(a!=="loaded"){this[d.status]=false;return false}}var f=true;for(var b in this[d.map]){if(b&&this[d.map].hasOwnProperty(b)&&this[d.map][b]!=="loaded"){f=false;break}}this[d.status]=f;return f},loadImage:function(b){var a=new Image();a.onload=a.onerror=a.onabort=(function(){a.onload=a.onerror=a.onabort=null;this.updateLoadStatus(b,"loaded","image");if(this.imageLoadFinished){var e;for(var c=0,d=this.imageLoadFnArray.length;c<d;c++){e=this.imageLoadFnArray.shift();e()}e=null}}).proxy(this);a.src=b},fastClone:function(b){var a=function(){};a.prototype=b;return new a()},declare:function(j){var m=false;var f=j();var g=f.name;if(!g){throw"can't find the obj name"}var d=f.namespace;var c=d+"."+g;var k=c.split(".");var h=k.length;var l=window;var a="";for(var e=0;e<h-1;e++){var b=k[e];if(l==window){l[b]=window[b]=window[b]||{};a+=b}else{l[b]=l[b]||{};a+="."+b}l=l[b];this.cache[a]=l}l[g]=l[g]||f;this.cache=this.cache||{};this.cache[c]=l[g];m=true;return m},using:function(a,g,e){if(this.cache&&this.cache[a]){return this.cache[a]}g=g||"class";e=e||this.config.version[g]||"1.0.0";var l;switch(g){case"image":if(a.indexOf("http")<0){a=this.config.baseUrl+"img/"+((e&&e!=="0")?e.toString():"")+"/"+a}this.updateLoadStatus(a,"loading","image");this.loadImage(a);l=a;break;case"class":var j=this.getKeysByType(g);var f=a.split(".");l=window[f[0]];for(var b=1,c=f.length;b<c;b++){if(l&&l[f[b]]){l=l[f[b]]}else{l=null}}if(!l){if(!this[j.map][a]){this.updateLoadStatus(a,"loading","class");var h=document.createElement("script");h.type="text/javascript";h.async=true;var d=this.config.baseUrl+"js/";if(e&&e!=="0"){d+=e.toString()+"/"}d+=a.replace(/\./gi,"/")+".js";h.src=d.toLowerCase();h.onload=h.onerror=h.onreadystatechange=(function(){if(/loaded|complete|undefined/.test(h.readyState)){h.onload=h.onerror=h.onreadystatechange=null;if(this.updateLoadStatus(a,"loaded","class")){var o;for(var m=0,n=this[j.array].length;m<n;m++){o=this[j.array].shift();o()}o=null}h=undefined}}).proxy(this);var k=document.getElementsByTagName("script")[0];k.parentNode.insertBefore(h,k)}}this.cache=this.cache||{};this.cache[a]=l}return l},config:function(a){if(a){this.config=a}},run:function(b,a){if(!b){return}var c=this.getKeysByType();if(this[c.status]){b()}else{this[c.array].push(b)}}};Function.prototype.proxy=function(b){var d=this;var a=Array.prototype.slice.apply(arguments);var c=a.shift();return function(e){return d.apply(c,arguments)}};window.declare=Base.declare.proxy(Base);window.using=Base.using.proxy(Base);window.run=Base.run.proxy(Base);window.config=Base.config.proxy(Base);document.execCommand("BackgroundImageCache",false,true);